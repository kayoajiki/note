# ペルソナブログ

一人1アカウントで、複数の「ペルソナ」（Aさん・Bさん・Cさん…）を登録し、選択したペルソナの考え・文体でAIがブログ記事を生成するWebアプリです。他アカウントのデータは、そのアカウントのメールとパスワードでログインしないと見られません。

## 機能

- **認証**: 一人1アカウント。新規登録（メールアドレス＋パスワード）でアカウント作成。ログインはメール＋パスワード。
- **ペルソナ**: 1アカウント内で複数登録可能。各ペルソナに「システムプロンプト」と「ルール」を設定。
- **プロンプト作成**: 過去文章の貼り付け、または note.com のURLから本文を取得してAIがプロンプトを自動生成。生成後は手動で編集可能。
- **記事生成**: アイデア・単語を入力すると、選択したペルソナの文体でブログ本文を生成。微修正（指示で修正を反映）・履歴参照・最終版のみ保存に対応。
- **記事一覧**: 保存した記事を一覧・詳細表示。ペルソナでフィルタ可能。

## セットアップ

1. 依存関係のインストール  
   `npm install`

2. 環境変数  
   `.env.example` をコピーして `.env` を作成し、以下を設定する。
   - `DATABASE_URL`: SQLite の場合は `file:./dev.db`
   - `NEXTAUTH_SECRET`: 32文字以上のランダム文字列
   - `NEXTAUTH_URL`: 開発時は `http://localhost:3000`
   - `AI_PROVIDER`: `openai` / `anthropic` / `gemini` のいずれか
   - OpenAI: `OPENAI_API_KEY`
   - Anthropic: `ANTHROPIC_API_KEY`
   - Gemini: `GEMINI_API_KEY`（任意で `GEMINI_MODEL`、未指定時は `gemini-2.5-flash`）

3. DBの準備  
   `npx prisma db push`  
   既存の Persona がある場合、初回のみ `npm run db:seed` で初期ユーザー（admin@example.com / changeme）を作成し、既存ペルソナをそのユーザーに紐付けます。

4. 開発サーバー起動  
   `npm run dev`

5. ブラウザで `http://localhost:3000` を開く。新規登録でアカウントを作成するか、既存アカウントでログインする。

## 使い方

1. 「新規登録はこちら」からメールアドレス・パスワード（6文字以上）でアカウントを作成する。
2. ログイン後、ダッシュボードで「新規ペルソナを追加」からペルソナ（例: Aさんのペルソナ）を作成する。
3. そのペルソナの「編集」から、過去文章を貼り付けるか note のURLを入力し「プロンプトを生成」を押す。必要に応じてプロンプトとルールを編集して保存する。
4. 上段のタブでペルソナを選び、「書く」画面でアイデア・単語を入力して「文章を生成」する。微修正で指示を出して修正を反映し、「この内容で保存」すると記事一覧に追加される。
